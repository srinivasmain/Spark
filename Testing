Description:
Test the get_column_details method with sample data.

Steps to execute:

Load properties and get the JSON file path.

python
Copy code
result = load_properties("dcm")
json_filepath = result["read_json"]["json_file_path"]
Create a Spark session and load the sample JSON data into a DataFrame.

python
Copy code
spark = sparkUtil.create_spark_session("spark")
json_df = sparkUtil.create_json_dataframe(spark, json_filepath)
Call the get_column_details method with the sample DataFrame.

python
Copy code
result_df = get_column_details(json_df)
result_df.show()
Load expected data from a CSV file.

python
Copy code
expected_df = spark.read.csv(r"C:\Users\ZKNZYJ5\Documents\dcm\dcm\tests\Sample_test.csv", header=True, mode="overwrite")
expected_df.show()
Compare the first two records of result and expected DataFrames.

python
Copy code
res_first_rec = result_df.head(2)
exp_first_rec = expected_df.head(2)
print("=====res_first_rec===", res_first_rec)
print("=====exp_first_rec===", exp_first_rec)
Assert that the first record of the "columnName" column in both DataFrames is equal.

python
Copy code
self.assertEqual(result_df.select("columnName").first(), expected_df.select("columnName").first())
Expected result:

The get_column_details method should process the sample DataFrame correctly.
The result DataFrame and the expected DataFrame should match for the "columnName" column.
Actual result:
The test will output messages and show the result and expected DataFrames to help verify the correctness of the get_column_details method.





Message ChatGPTâ€¦
