# Code Analysis:

## 1. Extraction of Relevant Columns:
   - The code extracts relevant columns from the `table_details_df` and `ast_relation_df`, storing them in `hive_tbl_dtls_df` and `ast_tables_hierarchy_df`, respectively.

## 2. Joining DataFrames:
   - An inner join is performed between `ast_relation_df` and `hive_tbl_dtls_df` to create `dcm_hive_inner_df`. The join is based on matching cluster, database, and table names.

## 3. Column Comparison and Soft Deletion:
   - A left join is executed between `dcm_hive_inner_df` and `col_details_df` to create `col_joined_df`. The code then identifies unmatched columns in the Oracle DataFrame by comparing column names.
   - A new DataFrame, `soft_deleted_df`, is generated to store unmatched columns with an additional "is_deleted" column set to 1.

## 4. Result Filtering and Display:
   - The code filters rows in `col_joined_df` where the "columnName" is null (indicating unmatched columns) and drops duplicate rows to create `res_df`.
   - Both `res_df` and `soft_deleted_df` are displayed, providing insights into the results.

## 5. Considerations:
   - The code assumes that the columns used in joins and comparisons exist in the provided DataFrames. Ensure column name consistency.
   - The soft deletion strategy involves marking unmatched columns, allowing for a controlled deletion process. Adjust as per specific business requirements.

## 6. Output and Next Steps:
   - The code outputs two DataFrames: `res_df` with unmatched column information and `soft_deleted_df` marking the soft-deleted columns.
   - Further steps may involve additional analysis of soft-deleted columns or integrating the results into downstream processes.

## 7. Conclusion:
   - The code effectively addresses the objective of processing Hive tech metadata, comparing columns, and implementing a soft deletion strategy for unmatched columns in the Oracle DataFrame.
   - With proper column validation and adjustment of the soft deletion approach, this code serves as a robust foundation for maintaining data integrity and quality in a mixed-metadata environment.
